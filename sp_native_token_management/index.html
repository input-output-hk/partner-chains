<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Primitives and inherent data provider for the Native Token Management feature"><title>sp_native_token_management - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Italic-81dc35de.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-MediumItalic-ccf7e434.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2"href="../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../static.files/rustdoc-e56847b5.css"><meta name="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="sp_native_token_management" data-themes="" data-resource-suffix="" data-rustdoc-version="1.92.0-nightly (4645a7988 2025-09-17)" data-channel="nightly" data-search-js="search-cb266a1a.js" data-stringdex-js="stringdex-5af928a3.js" data-settings-js="settings-c38705f0.js" ><script src="../static.files/storage-e2aeef58.js"></script><script defer src="../crates.js"></script><script defer src="../static.files/main-6dc2a7f3.js"></script><noscript><link rel="stylesheet" href="../static.files/noscript-263c88ec.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-eab170b8.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-044be391.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><rustdoc-topbar><h2><a href="#">Crate sp_native_token_management</a></h2></rustdoc-topbar><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../sp_native_token_management/index.html">sp_<wbr>native_<wbr>token_<wbr>management</a><span class="version">1.7.0</span></h2></div><div class="sidebar-elems"><ul class="block"><li><a id="all-types" href="all.html">All Items</a></li></ul><section id="rustdoc-toc"><h3><a href="#">Sections</a></h3><ul class="block top-toc"><li><a href="#purpose-and-context" title="Purpose and context">Purpose and context</a></li><li><a href="#usage" title="Usage">Usage</a><ul><li><a href="#prerequisites" title="Prerequisites">Prerequisites</a></li><li><a href="#implementing-runtime-apis" title="Implementing runtime APIs">Implementing runtime APIs</a></li><li><a href="#adding-the-inherent-data-provider" title="Adding the inherent data provider">Adding the inherent data provider</a></li></ul></li></ul><h3><a href="#structs">Crate Items</a></h3><ul class="block"><li><a href="#structs" title="Structs">Structs</a></li><li><a href="#enums" title="Enums">Enums</a></li><li><a href="#constants" title="Constants">Constants</a></li><li><a href="#traits" title="Traits">Traits</a></li></ul></section><div id="rustdoc-modnav"></div></div></nav><div class="sidebar-resizer" title="Drag to resize sidebar"></div><main><div class="width-limiter"><section id="main-content" class="content"><div class="main-heading"><h1>Crate <span>sp_<wbr>native_<wbr>token_<wbr>management</span>&nbsp;<button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../src/sp_native_token_management/lib.rs.html#1-337">Source</a> </span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Primitives and inherent data provider for the Native Token Management feature</p>
<h2 id="purpose-and-context"><a class="doc-anchor" href="#purpose-and-context">§</a>Purpose and context</h2>
<p>This crate defines shared types used by components that implement the Native Token Management
feature of the Partner Chains toolkit, along with an inherent data provider for token transfer
data.</p>
<p>The Native Token Management feature allows a Partner Chain to keep its token as a native asset
on Cardano and have it be transferable to the Partner Chain. This is achieved by the native
token being locked at an <em>illiquid supply</em> address on Cardano, and the Partner Chain handling
this locking event (a <em>transfer</em>) after it has been observed as part of a stable block.</p>
<p>The inherent data provider defined in this crate is responsible for providing information about
the transfers in form of inherent data, and handling them is the responsibility of the pallet,
which allows the Partner Chain builders to define their own transfer handling logic to suit
their needs.</p>
<h2 id="usage"><a class="doc-anchor" href="#usage">§</a>Usage</h2><h3 id="prerequisites"><a class="doc-anchor" href="#prerequisites">§</a>Prerequisites</h3>
<p>This features depends on the MC Reference Hash feature to provide Cardano block reference for
querying the token transfers. See the documentation of <code>sidechain_mc_hash</code> crate for more information.</p>
<h3 id="implementing-runtime-apis"><a class="doc-anchor" href="#implementing-runtime-apis">§</a>Implementing runtime APIs</h3>
<p><a href="struct.NativeTokenManagementInherentDataProvider.html" title="struct sp_native_token_management::NativeTokenManagementInherentDataProvider">NativeTokenManagementInherentDataProvider</a> requires the runtime to implement the
<a href="trait.NativeTokenManagementApi.html" title="trait sp_native_token_management::NativeTokenManagementApi">NativeTokenManagementApi</a> runtime API. This only requires passing relevant values from the pallet:</p>

<div class="example-wrap ignore"><a href="#" class="tooltip" title="This example is not tested">ⓘ</a><pre class="rust rust-example-rendered"><code><span class="kw">impl </span>sp_native_token_management::NativeTokenManagementApi&lt;Block&gt; <span class="kw">for </span>Runtime {
	<span class="kw">fn </span>get_main_chain_scripts() -&gt; <span class="prelude-ty">Option</span>&lt;sp_native_token_management::MainChainScripts&gt; {
		NativeTokenManagement::get_main_chain_scripts()
	}
	<span class="kw">fn </span>initialized() -&gt; bool {
		NativeTokenManagement::initialized()
	}
}</code></pre></div><h3 id="adding-the-inherent-data-provider"><a class="doc-anchor" href="#adding-the-inherent-data-provider">§</a>Adding the inherent data provider</h3>
<p>The inherent data provider requires a data source implementing <a href="trait.NativeTokenManagementDataSource.html" title="trait sp_native_token_management::NativeTokenManagementDataSource">NativeTokenManagementDataSource</a>.
A Db-Sync implementation is provided by the <code>partner_chains_db_sync_data_sources</code> crate.</p>
<p>With the data source present, the IDP is straightfoward to create:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::sync::Arc;
<span class="kw">use </span>sp_runtime::traits::Block <span class="kw">as </span>BlockT;
<span class="kw">use </span>sp_native_token_management::<span class="kw-2">*</span>;

<span class="kw">async fn </span>create_idps&lt;Block: BlockT, C&gt;(
    parent_hash: Block::Hash,
    client: Arc&lt;C&gt;,
    native_token_data_source: <span class="kw-2">&amp;</span>(<span class="kw">dyn </span>NativeTokenManagementDataSource + Send + Sync)
) -&gt; <span class="prelude-ty">Result</span>&lt;(NativeTokenManagementInherentDataProvider <span class="comment">/* other IDPs */</span>), Box&lt;<span class="kw">dyn </span>std::error::Error + Send + Sync&gt;&gt;
<span class="kw">where
    </span>C: sp_api::ProvideRuntimeApi&lt;Block&gt; + Send + Sync,
    C::Api: NativeTokenManagementApi&lt;Block&gt;
{
    <span class="kw">let </span>(mc_hash, previous_mc_hash) = <span class="macro">todo!</span>(<span class="string">"Should come from the MC Reference Hash feature"</span>);

    <span class="kw">let </span>native_token_idp = NativeTokenManagementInherentDataProvider::new(
    	client.clone(),
    	native_token_data_source,
    	mc_hash,
    	previous_mc_hash,
    	parent_hash,
    )
    .<span class="kw">await</span><span class="question-mark">?</span>;
    <span class="prelude-val">Ok</span>((native_token_idp <span class="comment">/* other IDPs */</span>))
}</code></pre></div>
<p>The same constructor can be used for both proposal and validation of blocks.</p>
</div></details><h2 id="structs" class="section-header">Structs<a href="#structs" class="anchor">§</a></h2><dl class="item-table"><dt><a class="struct" href="struct.MainChainScripts.html" title="struct sp_native_token_management::MainChainScripts">Main<wbr>Chain<wbr>Scripts</a></dt><dd>Values identifying on-chain entities involved in the native token management system on Cardano.</dd><dt><a class="struct" href="struct.NativeTokenManagementInherentDataProvider.html" title="struct sp_native_token_management::NativeTokenManagementInherentDataProvider">Native<wbr>Token<wbr>Management<wbr>Inherent<wbr>Data<wbr>Provider</a></dt><dd>Inherent data provider that provides aggregate number of native token transfers to the illiquid supply on Cardano
in some time range.</dd><dt><a class="struct" href="struct.TokenTransferData.html" title="struct sp_native_token_management::TokenTransferData">Token<wbr>Transfer<wbr>Data</a></dt><dd>Data about token transfers in some period of time</dd></dl><h2 id="enums" class="section-header">Enums<a href="#enums" class="anchor">§</a></h2><dl class="item-table"><dt><a class="enum" href="enum.IDPCreationError.html" title="enum sp_native_token_management::IDPCreationError">IDPCreation<wbr>Error</a></dt><dd>Error type returned when creation of <a href="struct.NativeTokenManagementInherentDataProvider.html" title="struct sp_native_token_management::NativeTokenManagementInherentDataProvider">NativeTokenManagementInherentDataProvider</a> fails</dd><dt><a class="enum" href="enum.InherentError.html" title="enum sp_native_token_management::InherentError">Inherent<wbr>Error</a></dt><dd>Error type returned by the Native Token Management pallet inherent logic</dd></dl><h2 id="constants" class="section-header">Constants<a href="#constants" class="anchor">§</a></h2><dl class="item-table"><dt><a class="constant" href="constant.INHERENT_IDENTIFIER.html" title="constant sp_native_token_management::INHERENT_IDENTIFIER">INHERENT_<wbr>IDENTIFIER</a></dt><dd>Inherent identifier used by the Native Token Management pallet</dd></dl><h2 id="traits" class="section-header">Traits<a href="#traits" class="anchor">§</a></h2><dl class="item-table"><dt><a class="trait" href="trait.NativeTokenManagementApi.html" title="trait sp_native_token_management::NativeTokenManagementApi">Native<wbr>Token<wbr>Management<wbr>Api</a></dt><dd>Runtime API exposing configuration and initialization status of the Native Token Management pallet</dd><dt><a class="trait" href="trait.NativeTokenManagementDataSource.html" title="trait sp_native_token_management::NativeTokenManagementDataSource">Native<wbr>Token<wbr>Management<wbr>Data<wbr>Source</a></dt><dd>Interface for a data source serving native token transfer data compatible with <a href="struct.NativeTokenManagementInherentDataProvider.html" title="struct sp_native_token_management::NativeTokenManagementInherentDataProvider">NativeTokenManagementInherentDataProvider</a>.</dd></dl></section></div></main></body></html>