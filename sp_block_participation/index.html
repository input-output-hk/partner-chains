<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Crate providing block participation data through the inherent data mechanism."><title>sp_block_participation - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Italic-81dc35de.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-MediumItalic-ccf7e434.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../static.files/rustdoc-0ce1a80b.css"><meta name="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="sp_block_participation" data-themes="" data-resource-suffix="" data-rustdoc-version="1.89.0-nightly (d97326eab 2025-05-15)" data-channel="nightly" data-search-js="search-f7877310.js" data-settings-js="settings-5514c975.js" ><script src="../static.files/storage-4e99c027.js"></script><script defer src="../crates.js"></script><script defer src="../static.files/main-7ef8a74a.js"></script><noscript><link rel="stylesheet" href="../static.files/noscript-32bb7600.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-6580c154.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-044be391.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../sp_block_participation/index.html">sp_<wbr>block_<wbr>participation</a><span class="version">1.6.0</span></h2></div><div class="sidebar-elems"><ul class="block"><li><a id="all-types" href="all.html">All Items</a></li></ul><section id="rustdoc-toc"><h3><a href="#">Sections</a></h3><ul class="block top-toc"><li><a href="#purpose-of-this-crate" title="Purpose of this crate">Purpose of this crate</a></li><li><a href="#outline-of-operation" title="Outline of operation">Outline of operation</a></li><li><a href="#usage" title="Usage">Usage</a></li></ul><h3><a href="#modules">Crate Items</a></h3><ul class="block"><li><a href="#modules" title="Modules">Modules</a></li><li><a href="#structs" title="Structs">Structs</a></li><li><a href="#enums" title="Enums">Enums</a></li><li><a href="#constants" title="Constants">Constants</a></li><li><a href="#traits" title="Traits">Traits</a></li></ul></section><div id="rustdoc-modnav"></div></div></nav><div class="sidebar-resizer" title="Drag to resize sidebar"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><h1>Crate <span>sp_block_participation</span><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../src/sp_block_participation/lib.rs.html#1-479">Source</a> </span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Crate providing block participation data through the inherent data mechanism.</p>
<h3 id="purpose-of-this-crate"><a class="doc-anchor" href="#purpose-of-this-crate">§</a>Purpose of this crate</h3>
<p>This crate provides logic to compute and expose as inherent data aggregated information on block producers’
and their delegators’ participation in block production. This feature is implemented in an unusual way in
that it publishes inherent data but leaves it to the specific Partner Chain’s builders to implement the pallet
that will consume this data. This is done because Partner Chains SDK can not anticipate how this data will
have to be handled within every Partner Chain. The assumed use of the data provided is paying out of block
production reward, however both ledger structure and reward calculation rules are inherently specific to
their Partner Chain.</p>
<h3 id="outline-of-operation"><a class="doc-anchor" href="#outline-of-operation">§</a>Outline of operation</h3>
<ol>
<li>The inherent data provider calls runtime API to check whether it should release block participation inherent
data (all points below assume this check is positive) and gets the upper slot limit.</li>
<li>The inherent data provider retrieves data on block production up to the slot limit using runtime API and Cardano
delegation data using observability data source. The IDP joins and aggregates this data together producing
block participation data.</li>
<li>The IDP puts the block participation data into the inherent data of the current block, under the inherent
identifier indicated by the runtime API. This inherent identifier belongs to the Partner Chain’s custom
handler crate.</li>
<li>The IDP produces an additional “operational” inherent data to signal its own pallet that participation data
has been released.</li>
<li>The Partner Chain’s custom handler pallet consumes the block participation inherent data and produces an
inherent that performs block rewards payouts or otherwise handles the data according to this particular
Partner Chain’s rules.</li>
<li>The block participation pallet consumes the operational inherent data and cleans up block production data
up to the slot limit.</li>
</ol>
<h3 id="usage"><a class="doc-anchor" href="#usage">§</a>Usage</h3>
<p>To incorporate this feature into a Partner Chain, one must do the following:</p>
<ol>
<li>Implement a pallet consuming inherent data of type <a href="struct.BlockProductionData.html" title="struct sp_block_participation::BlockProductionData">BlockProductionData</a></li>
<li>Include the block participation pallet into their runtime and configure it. Consult the documentation of
<code>pallet_block_participation</code> for details.</li>
<li>Implement <a href="trait.BlockParticipationApi.html" title="trait sp_block_participation::BlockParticipationApi">BlockParticipationApi</a> for their runtime.</li>
<li>Include <a href="inherent_data/enum.BlockParticipationInherentDataProvider.html" title="enum sp_block_participation::inherent_data::BlockParticipationInherentDataProvider">inherent_data::BlockParticipationInherentDataProvider</a> in their node’s inherent data
provider set for both proposal and verification of blocks.</li>
</ol>
<p>Configuring the pallet and implementing the runtime API requires there to be a source of block production data
present in the runtime that can be used by the feature. The intended source is <code>pallet_block_production_log</code> but
in principle anu pallet offering a similar interfaces can be used. An example of runtime API implementation using
the block participation log pallet looks like the following:</p>

<div class="example-wrap ignore"><a href="#" class="tooltip" title="This example is not tested">ⓘ</a><pre class="rust rust-example-rendered"><code><span class="kw">impl </span>sp_block_participation::BlockParticipationApi&lt;Block, BlockAuthor&gt; <span class="kw">for </span>Runtime {
	<span class="kw">fn </span>should_release_data(slot: Slot) -&gt; <span class="prelude-ty">Option</span>&lt;Slot&gt; {
		BlockParticipationPallet::should_release_data(slot)
	}
	<span class="kw">fn </span>blocks_produced_up_to_slot(slot: Slot) -&gt; Vec&lt;(Slot, BlockAuthor)&gt; {
		&lt;Runtime <span class="kw">as </span>pallet_block_participation::Config&gt;::blocks_produced_up_to_slot(slot).collect()
	}
	<span class="kw">fn </span>target_inherent_id() -&gt; InherentIdentifier {
		&lt;Runtime <span class="kw">as </span>pallet_block_participation::Config&gt;::TARGET_INHERENT_ID
	}
}</code></pre></div>
</div></details><h2 id="modules" class="section-header">Modules<a href="#modules" class="anchor">§</a></h2><dl class="item-table"><dt><a class="mod" href="inherent_data/index.html" title="mod sp_block_participation::inherent_data">inherent_<wbr>data</a></dt><dd>Inherent data provider definitions and implementation for Block Producer feature</dd></dl><h2 id="structs" class="section-header">Structs<a href="#structs" class="anchor">§</a></h2><dl class="item-table"><dt><a class="struct" href="struct.BlockProducerParticipationData.html" title="struct sp_block_participation::BlockProducerParticipationData">Block<wbr>Producer<wbr>Participation<wbr>Data</a></dt><dd>Aggregated data on block production of one block producer in one aggregation period.</dd><dt><a class="struct" href="struct.BlockProductionData.html" title="struct sp_block_participation::BlockProductionData">Block<wbr>Production<wbr>Data</a></dt><dd>Aggregated data on block production, grouped by the block producer and aggregation period (main chain epoch).</dd><dt><a class="struct" href="struct.DelegatorBlockParticipationData.html" title="struct sp_block_participation::DelegatorBlockParticipationData">Delegator<wbr>Block<wbr>Participation<wbr>Data</a></dt><dd>Represents a block producer’s delegator along with their number of shares in that block producer’s pool.</dd><dt><a class="struct" href="struct.Slot.html" title="struct sp_block_participation::Slot">Slot</a></dt><dd>Unit type wrapper that represents a slot.</dd><dt><a class="struct" href="struct.SlotDuration.html" title="struct sp_block_participation::SlotDuration">Slot<wbr>Duration</a></dt><dd>A slot duration defined in milliseconds.</dd></dl><h2 id="enums" class="section-header">Enums<a href="#enums" class="anchor">§</a></h2><dl class="item-table"><dt><a class="enum" href="enum.InherentError.html" title="enum sp_block_participation::InherentError">Inherent<wbr>Error</a></dt><dd>Error type returned by the Block Participation pallet’s inherent</dd></dl><h2 id="constants" class="section-header">Constants<a href="#constants" class="anchor">§</a></h2><dl class="item-table"><dt><a class="constant" href="constant.INHERENT_IDENTIFIER.html" title="constant sp_block_participation::INHERENT_IDENTIFIER">INHERENT_<wbr>IDENTIFIER</a></dt><dd>Inherent identifier used by the Block Participation pallet</dd></dl><h2 id="traits" class="section-header">Traits<a href="#traits" class="anchor">§</a></h2><dl class="item-table"><dt><a class="trait" href="trait.AsCardanoSPO.html" title="trait sp_block_participation::AsCardanoSPO">AsCardanoSPO</a></dt><dd>Signifies that a type or some of its variants represents a Cardano stake pool operator</dd><dt><a class="trait" href="trait.BlockParticipationApi.html" title="trait sp_block_participation::BlockParticipationApi">Block<wbr>Participation<wbr>Api</a></dt><dd>Runtime api exposing configuration and runtime bindings necessary for <a href="inherent_data/enum.BlockParticipationInherentDataProvider.html" title="enum sp_block_participation::inherent_data::BlockParticipationInherentDataProvider">inherent_data::BlockParticipationInherentDataProvider</a>.</dd><dt><a class="trait" href="trait.CardanoDelegator.html" title="trait sp_block_participation::CardanoDelegator">Cardano<wbr>Delegator</a></dt><dd>Signifies that a type represents a Cardano delegator</dd></dl></section></div></main></body></html>