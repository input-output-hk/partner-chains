<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Pallet providing configuration and supporting runtime logic for the block participation data feature of Partner Chains SDK."><title>pallet_block_participation - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-46f98efaafac5295.ttf.woff2,FiraSans-Regular-018c141bf0843ffd.woff2,FiraSans-Medium-8f9a781e4970d388.woff2,SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2,SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-c5d6553a23f1e5a6.css"><meta name="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="pallet_block_participation" data-themes="" data-resource-suffix="" data-rustdoc-version="1.81.0 (eeb90cda1 2024-09-04)" data-channel="1.81.0" data-search-js="search-d234aafac6c221dd.js" data-settings-js="settings-4313503d2e1961c2.js" ><script src="../static.files/storage-118b08c4c78b968e.js"></script><script defer src="../crates.js"></script><script defer src="../static.files/main-d2fab2bf619172d3.js"></script><noscript><link rel="stylesheet" href="../static.files/noscript-df360f571f6edeae.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../pallet_block_participation/index.html">pallet_block_participation</a><span class="version">1.6.0</span></h2></div><div class="sidebar-elems"><ul class="block"><li><a id="all-types" href="all.html">All Items</a></li></ul><section><ul class="block"><li><a href="#modules">Modules</a></li></ul></section></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><h1>Crate <a class="mod" href="#">pallet_block_participation</a><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><span class="out-of-band"><a class="src" href="../src/pallet_block_participation/lib.rs.html#1-176">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Pallet providing configuration and supporting runtime logic for the block participation data feature of Partner Chains SDK.</p>
<h3 id="purpose-of-this-pallet"><a class="doc-anchor" href="#purpose-of-this-pallet">§</a>Purpose of this pallet</h3>
<p>This pallet provides the runtime-side logic supporting the block participation data feature of PC SDK.
Unlike most pallets, this one is not meant to be interacted with either by the chain’s users or other
runtime components in the system. Instead, it only serves two purposes:</p>
<ul>
<li>it provides all configuration required by the feature’s inherent data provider defined in the primitives crate</li>
<li>it provides an inhrenent extrinsic that removes from the runtime storage data that has been already
processed by the inherent data provider
The reason for that is that the feature’s purpose is to produce inherent data containing block participation
data for consumption by custom-written pallet provided by each Partner Chain itself.</li>
</ul>
<p>The pallet is expected to be used together with the <code>pallet_block_production_log</code> when deployed in the
context of Partner Chains SDK.</p>
<h3 id="usage"><a class="doc-anchor" href="#usage">§</a>Usage</h3><h4 id="adding-into-the-runtime"><a class="doc-anchor" href="#adding-into-the-runtime">§</a>Adding into the runtime</h4>
<p>The pallet’s configuration can be divided into three groups by purpose:</p>
<ul>
<li><code>BlockAuthor</code> and <code>DelegatorId</code> types representing block authors and their dependant block beneficiaries</li>
<li><code>should_release_data</code> function that controls when the inherent data provider is active</li>
<li><code>blocks_produced_up_to_slot</code> and <code>blocks_produced_upd_to_slot</code> functions that provide bindings for consuming
(reading and clearing) block production data. Most easily these should come from <code>pallet_block_production_log</code>.</li>
</ul>
<p>Consult documentation of <a href="pallet/trait.Config.html" title="trait pallet_block_participation::pallet::Config">pallet::Config</a> for details on each configuration field.</p>
<p>Assuming that the runtime also contains the <code>pallet_block_production_log</code>, an example configuration of
the pallet might look like the following:</p>

<div class="example-wrap ignore"><a href="#" class="tooltip" title="This example is not tested">ⓘ</a><pre class="rust rust-example-rendered"><code><span class="kw">const </span>RELEASE_PERIOD: u64 = <span class="number">128</span>;

<span class="kw">impl </span>pallet_block_participation::Config <span class="kw">for </span>Runtime {
    <span class="kw">type </span>WeightInfo = pallet_block_participation::weights::SubstrateWeight&lt;Runtime&gt;;
    <span class="kw">type </span>BlockAuthor = BlockAuthor;
    <span class="kw">type </span>DelegatorId = DelegatorKey;

    <span class="comment">// release data every `RELEASE_PERIOD` blocks, up to current slot
    </span><span class="kw">fn </span>should_release_data(slot: sidechain_slots::Slot) -&gt; <span class="prelude-ty">Option</span>&lt;sidechain_slots::Slot&gt; {
        <span class="kw">if </span>System::block_number() % RELEASE_PERIOD == <span class="number">0 </span>{
            <span class="prelude-val">Some</span>(slot)
        } <span class="kw">else </span>{
            <span class="prelude-val">None
        </span>}
    }

    <span class="kw">fn </span>blocks_produced_up_to_slot(slot: Slot) -&gt; <span class="kw">impl </span>Iterator&lt;Item = (Slot, BlockAuthor)&gt; {
        BlockProductionLog::peek_prefix(slot)
    }

    <span class="kw">fn </span>discard_blocks_produced_up_to_slot(slot: Slot) {
        BlockProductionLog::drop_prefix(<span class="kw-2">&amp;</span>slot)
    }

    <span class="kw">const </span>TARGET_INHERENT_ID: InherentIdentifier = <span class="kw-2">*</span><span class="string">b"_example"</span>;
}</code></pre></div>
</div></details><h2 id="reexports" class="section-header">Re-exports<a href="#reexports" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><code>pub use <a class="mod" href="pallet/index.html" title="mod pallet_block_participation::pallet">pallet</a>::*;</code></div></li></ul><h2 id="modules" class="section-header">Modules<a href="#modules" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="mod" href="pallet/index.html" title="mod pallet_block_participation::pallet">pallet</a></div><div class="desc docblock-short">The <code>pallet</code> module in each FRAME pallet hosts the most important items needed
to construct this pallet.</div></li><li><div class="item-name"><a class="mod" href="weights/index.html" title="mod pallet_block_participation::weights">weights</a></div><div class="desc docblock-short">Autogenerated weights for pallet_block_participation</div></li></ul></section></div></main></body></html>